{"name":"Dataflow 1","ppdf:dataflowId":"fab0adbc-00cd-4a07-8e97-304dce88b3bf","ppdf:owner":{"tenantId":"e2c852c9-a592-4198-8b26-76695664931e","userId":"aefcfa2c-e7f1-4392-b701-cffd823e827d"},"ppdf:fastCopy":false,"version":"1.0","culture":"en-US","modifiedTime":"2024-03-06T17:05:36.9375396+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"queriesMetadata":{"raw_lineitems":{"queryId":"0b4880b9-04ef-4240-9d25-1017d3c5eac8","queryName":"raw_lineitems"},"raw_orders":{"queryId":"c04a62ff-3b29-4393-92f5-254f381b4aca","queryName":"raw_orders"},"raw_orders_DataDestination":{"queryId":"98aabeaf-469b-47c7-8d92-2d42916694ca","queryName":"raw_orders_DataDestination"},"raw_orders_WriteToDataDestination":{"queryId":"1c5e5e19-3f02-4943-be41-3ad246f29545","queryName":"raw_orders_WriteToDataDestination"},"raw_orders_TransformForWriteToDataDestination":{"queryId":"2d28d5f3-6650-4ae9-8194-8529a5ca54ae","queryName":"raw_orders_TransformForWriteToDataDestination"}},"document":"section Section1;\r\nshared raw_lineitems = let\r\n  Source = Lakehouse.Contents([]),\r\n  #\"Navigation 1\" = Source{[workspaceId = \"70a17356-a70d-4504-b45e-8af1c167b1fa\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[lakehouseId = \"2e6cad95-b447-45ed-b37b-bda0560ddf62\"]}[Data],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Id = \"raw_lineitems\", ItemKind = \"Table\"]}[Data]\r\nin\r\n  #\"Navigation 3\";\r\nshared raw_orders = let\r\n  Source = Lakehouse.Contents([]),\r\n  #\"Navigation 1\" = Source{[workspaceId = \"70a17356-a70d-4504-b45e-8af1c167b1fa\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[lakehouseId = \"2e6cad95-b447-45ed-b37b-bda0560ddf62\"]}[Data],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Id = \"raw_orders\", ItemKind = \"Table\"]}[Data],\r\n  #\"Merged queries\" = Table.NestedJoin(#\"Navigation 3\", {\"O_ORDERKEY\"}, raw_lineitems, {\"L_ORDERKEY\"}, \"raw_lineitems\", JoinKind.Inner),\r\n  #\"Expanded raw_lineitems\" = Table.ExpandTableColumn(#\"Merged queries\", \"raw_lineitems\", {\"L_ORDERKEY\", \"L_PARTKEY\", \"L_SUPPKEY\", \"L_LINENUMBER\", \"L_QUANTITY\", \"L_EXTENDEDPRICE\", \"L_DISCOUNT\", \"L_TAX\", \"L_RETURNFLAG\", \"L_LINESTATUS\", \"L_SHIPDATE\", \"L_COMMITDATE\", \"L_RECEIPTDATE\", \"L_SHIPINSTRUCT\", \"L_SHIPMODE\", \"L_COMMENT\", \"L_Empty\"}, {\"L_ORDERKEY\", \"L_PARTKEY\", \"L_SUPPKEY\", \"L_LINENUMBER\", \"L_QUANTITY\", \"L_EXTENDEDPRICE\", \"L_DISCOUNT\", \"L_TAX\", \"L_RETURNFLAG\", \"L_LINESTATUS\", \"L_SHIPDATE\", \"L_COMMITDATE\", \"L_RECEIPTDATE\", \"L_SHIPINSTRUCT\", \"L_SHIPMODE\", \"L_COMMENT\", \"L_Empty\"}),\r\n  #\"Added custom\" = Table.AddColumn(#\"Expanded raw_lineitems\", \"Year\", each Year([O_ORDERDATE]))\r\nin\r\n  #\"Added custom\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared raw_orders_DataDestination = let\r\n  Pattern = Lakehouse.Contents([]),\r\n  Navigation_1 = Pattern{[workspaceId = \"70a17356-a70d-4504-b45e-8af1c167b1fa\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"2e6cad95-b447-45ed-b37b-bda0560ddf62\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"fact_orderlinesGen2\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[O_ORDERKEY = nullable Int32.Type, O_CUSTKEY = nullable Int32.Type, O_ORDERSTATUS = nullable Text.Type, O_TOTALPRICE = nullable Double.Type, O_ORDERDATE = nullable Text.Type, O_ORDERPRIORITY = nullable Text.Type, O_CLERK = nullable Text.Type, #\"O_SHIP-PRIORITY\" = nullable Int32.Type, O_COMMENT = nullable Text.Type, O_Empty = nullable Text.Type, L_ORDERKEY = nullable Int32.Type, L_PARTKEY = nullable Int32.Type, L_SUPPKEY = nullable Int32.Type, L_LINENUMBER = nullable Int32.Type, L_QUANTITY = nullable Int32.Type, L_EXTENDEDPRICE = nullable Double.Type, L_DISCOUNT = nullable Double.Type, L_TAX = nullable Double.Type, L_RETURNFLAG = nullable Text.Type, L_LINESTATUS = nullable Text.Type, L_SHIPDATE = nullable Text.Type, L_COMMITDATE = nullable Text.Type, L_RECEIPTDATE = nullable Text.Type, L_SHIPINSTRUCT = nullable Text.Type, L_SHIPMODE = nullable Text.Type, L_COMMENT = nullable Text.Type, L_Empty = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"DefaultStaging\"]\r\nshared raw_orders_WriteToDataDestination = let\r\n  raw_orders_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = raw_orders_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], raw_orders_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  raw_orders_WriteToDataDestination;\r\nshared raw_orders_TransformForWriteToDataDestination = let\r\n    ColumnMappings = {[SourceColumnName = \"O_ORDERKEY\", DestinationColumnName = \"O_ORDERKEY\"], [SourceColumnName = \"O_CUSTKEY\", DestinationColumnName = \"O_CUSTKEY\"], [SourceColumnName = \"O_ORDERSTATUS\", DestinationColumnName = \"O_ORDERSTATUS\"], [SourceColumnName = \"O_TOTALPRICE\", DestinationColumnName = \"O_TOTALPRICE\"], [SourceColumnName = \"O_ORDERDATE\", DestinationColumnName = \"O_ORDERDATE\"], [SourceColumnName = \"O_ORDERPRIORITY\", DestinationColumnName = \"O_ORDERPRIORITY\"], [SourceColumnName = \"O_CLERK\", DestinationColumnName = \"O_CLERK\"], [SourceColumnName = \"O_SHIP-PRIORITY\", DestinationColumnName = \"O_SHIP-PRIORITY\"], [SourceColumnName = \"O_COMMENT\", DestinationColumnName = \"O_COMMENT\"], [SourceColumnName = \"O_Empty\", DestinationColumnName = \"O_Empty\"], [SourceColumnName = \"L_ORDERKEY\", DestinationColumnName = \"L_ORDERKEY\"], [SourceColumnName = \"L_PARTKEY\", DestinationColumnName = \"L_PARTKEY\"], [SourceColumnName = \"L_SUPPKEY\", DestinationColumnName = \"L_SUPPKEY\"], [SourceColumnName = \"L_LINENUMBER\", DestinationColumnName = \"L_LINENUMBER\"], [SourceColumnName = \"L_QUANTITY\", DestinationColumnName = \"L_QUANTITY\"], [SourceColumnName = \"L_EXTENDEDPRICE\", DestinationColumnName = \"L_EXTENDEDPRICE\"], [SourceColumnName = \"L_DISCOUNT\", DestinationColumnName = \"L_DISCOUNT\"], [SourceColumnName = \"L_TAX\", DestinationColumnName = \"L_TAX\"], [SourceColumnName = \"L_RETURNFLAG\", DestinationColumnName = \"L_RETURNFLAG\"], [SourceColumnName = \"L_LINESTATUS\", DestinationColumnName = \"L_LINESTATUS\"], [SourceColumnName = \"L_SHIPDATE\", DestinationColumnName = \"L_SHIPDATE\"], [SourceColumnName = \"L_COMMITDATE\", DestinationColumnName = \"L_COMMITDATE\"], [SourceColumnName = \"L_RECEIPTDATE\", DestinationColumnName = \"L_RECEIPTDATE\"], [SourceColumnName = \"L_SHIPINSTRUCT\", DestinationColumnName = \"L_SHIPINSTRUCT\"], [SourceColumnName = \"L_SHIPMODE\", DestinationColumnName = \"L_SHIPMODE\"], [SourceColumnName = \"L_COMMENT\", DestinationColumnName = \"L_COMMENT\"], [SourceColumnName = \"L_Empty\", DestinationColumnName = \"L_Empty\"]},\r\n    SourceColumns = Table.SelectColumns(raw_orders, List.Transform(ColumnMappings, each _[SourceColumnName])),\r\n    TargetColumns = Table.RenameColumns(SourceColumns, List.Transform(ColumnMappings, each {_[SourceColumnName], _[DestinationColumnName]}))\r\nin\r\n    TargetColumns;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]}}